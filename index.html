<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ™®é€šè©±æ°´å¹³æ¸¬è©¦æœ—è®€ä½œå“10è™Ÿ</title>
    <style>
        /* å­—é«”å®šç¾© */
        :root {
            --main-font: "Yuanti SC", "YouYuan", "Yu Yuan", "Microsoft YaHei", sans-serif;
            --pinyin-font: "Calibri", sans-serif;
            --primary-color: #4a90e2;
            --bg-color: #f5f7fa;
            --highlight-color: #fff9c4; /* æ·ºé»ƒè‰² */
            --track-off: #ccc;
            --track-on: #ffd700;
        }

        body {
            font-family: var(--main-font);
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: #333;
            line-height: 1.6;
            padding-bottom: 100px; /* ç‚ºåº•éƒ¨è»Œé“ç•™å‡ºç©ºé–“ */
        }

        /* æ¨™é¡Œå€åŸŸ */
        .header-container {
            position: fixed;
            top: 10px;
            right: 15px;
            text-align: right;
            z-index: 100;
            background: rgba(245, 247, 250, 0.9);
            padding: 5px;
            border-radius: 8px;
        }

        .main-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #000;
            margin: 0;
        }

        .disclaimer {
            font-size: 0.7rem;
            color: gray;
            max-width: 300px;
            margin-top: 5px;
            line-height: 1.2;
        }

        /* ç™»éŒ„é é¢ */
        #login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .login-box {
            text-align: center;
            padding: 20px;
            width: 80%;
            max-width: 300px;
        }

        .login-box h1 {
            margin-bottom: 30px;
        }

        .login-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .login-btn {
            width: 100%;
            padding: 10px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }

        /* ä¸»å†…å®¹å€åŸŸ */
        .content-container {
            max-width: 800px;
            margin: 80px auto 20px; /* é ‚éƒ¨ç•™ç©ºçµ¦æ¨™é¡Œ */
            padding: 20px;
            display: none; /* ç™»éŒ„å¾Œé¡¯ç¤º */
        }

        .sentence-block {
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 10px;
            background: white;
            transition: background-color 0.3s;
            border: 1px solid #eee;
        }

        .sentence-block.finished {
            background-color: var(--highlight-color);
        }

        .pinyin {
            font-family: var(--pinyin-font);
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 5px;
            word-spacing: 2px;
        }

        .hanzi {
            font-family: var(--main-font);
            font-size: 1.5rem;
            font-weight: bold;
            color: #222;
        }

        .controls {
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .play-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 5px 20px;
            cursor: pointer;
            font-family: var(--main-font);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .play-btn:active {
            transform: scale(0.98);
        }

        .play-btn.playing {
            background: #ff6b6b;
        }

        /* åº•éƒ¨çå‹µè»Œé“ */
        .reward-track-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            padding: 10px 0;
            z-index: 500;
            overflow-x: auto;
            display: none; /* ç™»éŒ„å¾Œé¡¯ç¤º */
        }

        .reward-track {
            display: flex;
            align-items: center;
            padding: 0 20px;
            min-width: max-content;
            gap: 5px;
        }

        .star {
            font-size: 1.2rem;
            color: var(--track-off);
            transition: color 0.3s, transform 0.3s;
        }

        .star.active {
            color: var(--track-on);
            transform: scale(1.2);
        }

        .trophy {
            font-size: 1.5rem;
            color: var(--track-off);
            margin-left: 10px;
            transition: all 0.5s;
        }

        .trophy.active {
            color: var(--track-on);
            text-shadow: 0 0 10px gold;
            animation: bounce 1s infinite alternate;
        }

        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-5px); }
        }

        /* å®ŒæˆæŒ‰éˆ•å€åŸŸ */
        .finish-section {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 120px;
            display: none; /* å®Œæˆå¾Œé¡¯ç¤º */
        }

        .finish-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* å½ˆçª— */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 3000;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .modal {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            width: 80%;
            max-width: 400px;
            animation: popIn 0.3s ease-out;
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .close-modal-btn {
            margin-top: 20px;
            padding: 8px 20px;
            background: #666;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        /* è¿”å›ä¸»é æŒ‰éˆ• */
        .home-btn-container {
            display: none;
            text-align: center;
            margin-top: 20px;
            padding-bottom: 120px;
        }

        .home-link {
            text-decoration: none;
            color: #333;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
        }

        .book-icon {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        /* é–‹ç™¼è€…æ¨¡å¼ */
        #dev-trigger {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 1.2rem;
            opacity: 0.3;
            cursor: pointer;
            z-index: 1000;
            filter: grayscale(100%);
        }

        #dev-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 300px;
            background: #1a1a1a;
            color: #0f0;
            z-index: 4000;
            display: none;
            padding: 20px;
            box-sizing: border-box;
            font-family: monospace;
            overflow-y: auto;
        }

        .dev-controls {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .dev-btn {
            background: #333;
            color: #fff;
            border: 1px solid #555;
            padding: 5px 10px;
            cursor: pointer;
            margin-right: 10px;
        }
    </style>
</head>
<body>

    <!-- éŸ³é »æ–‡ä»¶ -->
    <audio id="main-audio" src="pscleadreading10.mp3" preload="auto"></audio>

    <!-- é–‹ç™¼è€…å…¥å£ -->
    <div id="dev-trigger">ğŸ› ï¸</div>

    <!-- é–‹ç™¼è€…é¢æ¿ -->
    <div id="dev-panel">
        <div class="dev-controls">
            <h3>é–‹ç™¼è€…æ¨¡å¼ï¼šæ™‚é–“è»¸æ¨™è¨˜å·¥å…·</h3>
            <p>èª¬æ˜ï¼šé»æ“Šã€Œé–‹å§‹éŒ„è£½ã€ï¼ŒéŸ³é »å°‡æ’­æ”¾ã€‚æ¯è½åˆ°ä¸€å¥è©±çµæŸï¼Œç«‹å³æŒ‰ä¸‹ã€Œæ¨™è¨˜ä¸‹ä¸€å¥ã€æŒ‰éˆ•ï¼ˆæˆ–éµç›¤ç©ºç™½éµï¼‰ã€‚</p>
            <button class="dev-btn" id="start-record-btn">é–‹å§‹éŒ„è£½æ¨¡å¼</button>
            <button class="dev-btn" id="mark-point-btn">æ¨™è¨˜ä¸‹ä¸€å¥ (Space)</button>
            <button class="dev-btn" id="export-btn">è¤‡è£½ JSON ä»£ç¢¼</button>
            <span id="current-time-display">0.00s</span>
        </div>
        <div id="json-output">ç­‰å¾…éŒ„è£½...</div>
    </div>

    <!-- æ¨™é¡Œ -->
    <div class="header-container">
        <div class="main-title">æ™®é€šè©±æ°´å¹³æ¸¬è©¦æœ—è®€ä½œå“10è™Ÿ</div>
        <div class="disclaimer">
            æœ¬ç¶²é æ‹¼éŸ³å‡ç”±AIç”Ÿæˆï¼Œæ¨™æº–æ³¨éŸ³è«‹åƒè€ƒã€Šæ™®é€šè©±æ°´å¹³æ¸¬è©¦å¯¦æ–½ç¶±è¦ï¼ˆ2021å¹´ç‰ˆï¼‰ã€‹ã€‚<br>
            éŒ„éŸ³åƒ…ä¾›åƒè€ƒã€‚ç¶²é åƒ…ä¾›VTCå†…éƒ¨ä½¿ç”¨ã€‚<br>
            è·æ¥­è¨“ç·´å±€æ™®é€šè©±åŸ¹è¨“æ¸¬è©¦ä¸­å¿ƒç‰ˆæ¬Šæ‰€æœ‰ã€‚
        </div>
    </div>

    <!-- ç™»éŒ„é é¢ -->
    <div id="login-screen">
        <div class="login-box">
            <h1>é–‹å§‹ç·´ç¿’</h1>
            <input type="text" id="username" class="login-input" placeholder="è«‹è¼¸å…¥æ‚¨çš„åå­—">
            <input type="password" id="password" class="login-input" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
            <button class="login-btn" id="login-btn">é€²å…¥</button>
        </div>
    </div>

    <!-- å†…å®¹å€åŸŸ -->
    <div class="content-container" id="content-area">
        <!-- å¥å­å°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
    </div>

    <!-- å®ŒæˆæŒ‰éˆ• -->
    <div class="finish-section" id="finish-section">
        <button class="finish-btn" id="finish-all-btn">æˆ‘å·²å®Œæˆè·Ÿè®€ç·´ç¿’å•¦ï¼</button>
    </div>

    <!-- è¿”å›ä¸»é  -->
    <div class="home-btn-container" id="home-section">
        <a href="https://echo02-game.github.io/pscleadreading-hub/" class="home-link">
            <span class="book-icon">ğŸ“–</span>
            <span>å›ä¸»ç›®éŒ„</span>
        </a>
    </div>

    <!-- åº•éƒ¨çå‹µè»Œé“ -->
    <div class="reward-track-container" id="reward-track-container">
        <div class="reward-track" id="track">
            <!-- æ˜Ÿæ˜Ÿå’Œçæ¯ç”± JS ç”Ÿæˆ -->
        </div>
    </div>

    <!-- å½ˆçª— -->
    <div class="modal-overlay" id="success-modal">
        <div class="modal">
            <h2>å¤ªæ£’å•¦ï¼</h2>
            <p>æ‰“å¡ä¿¡æ¯å·²è¤‡è£½ï¼Œå¿«å»åˆ†äº«åŠªåŠ›å¾Œçš„å–œæ‚…å§ï¼</p>
            <button class="close-modal-btn" id="close-modal">é—œé–‰</button>
        </div>
    </div>

    <script>
        // ================= é…ç½®æ•¸æ“š =================
        // é‡è¦ï¼šé€™è£çš„ start/end æ™‚é–“éœ€è¦ä½¿ç”¨é–‹ç™¼è€…æ¨¡å¼ç”Ÿæˆå¾Œæ›¿æ›
        // ç›®å‰è¨­ç½®ç‚º 0ï¼Œè«‹å‹™å¿…ä½¿ç”¨ Dev Mode é€²è¡Œä¸€æ¬¡æ ¡æº–
        const sentenceData = [
    {
        "text": "æˆ‘æ„›æœˆå¤œï¼Œä½†æˆ‘ä¹Ÿæ„›æ˜Ÿå¤©ã€‚",
        "pinyin": "WÇ’ Ã i yuÃ¨ yÃ¨, dÃ n wÇ’ yÄ› Ã i xÄ«ng tiÄn.",
        "start": 0,
        "end": 9.142
    },
    {
        "text": "å¾å‰åœ¨å®¶é„‰ä¸ƒå…«æœˆçš„å¤œæ™šåœ¨åº­é™¢è£ç´æ¶¼çš„æ™‚å€™ï¼Œæˆ‘æœ€æ„›çœ‹å¤©ä¸Šå¯†å¯†éº»éº»çš„ç¹æ˜Ÿã€‚",
        "pinyin": "CÃ³ng qiÃ¡n zÃ i jiÄ xiÄng qÄ« bÄ yuÃ¨ de yÃ¨ wÇn zÃ i tÃ­ng yuÃ n lÇ nÃ  liÃ¡ng de shÃ­ hou, wÇ’ zuÃ¬ Ã i kÃ n tiÄn shÃ ng mÃ¬ mÃ¬ mÃ¡ mÃ¡ de fÃ¡n xÄ«ng.",
        "start": 9.142,
        "end": 21.22
    },
    {
        "text": "æœ›ç€æ˜Ÿå¤©ï¼Œæˆ‘å°±æœƒå¿˜è¨˜ä¸€åˆ‡ï¼Œä»¿ä½›å›åˆ°äº†æ¯è¦ªçš„æ‡·è£ä¼¼çš„ã€‚",
        "pinyin": "WÃ ng zhe xÄ«ng tiÄn, wÇ’ jiÃ¹ huÃ¬ wÃ ng jÃ¬ yÃ­ qiÃ¨, fÇng fÃº huÃ­ dÃ o le mÇ” qÄ«n de huÃ¡i lÇ shÃ¬ de.",
        "start": 21.22,
        "end": 30.592
    },
    {
        "text": "ä¸‰å¹´å‰åœ¨å—äº¬æˆ‘ä½çš„åœ°æ–¹æœ‰ä¸€é“å¾Œé–€ï¼Œæ¯æ™šæˆ‘æ‰“é–‹å¾Œé–€ï¼Œä¾¿çœ‹è¦‹ä¸€å€‹éœå¯‚çš„å¤œã€‚",
        "pinyin": "SÄn niÃ¡n qiÃ¡n zÃ i NÃ¡n jÄ«ng wÇ’ zhÃ¹ de dÃ¬ fang yÇ’u yÃ­ dÃ o hÃ²u mÃ©n, mÄ›i wÇn wÇ’ dÇ kÄi hÃ²u mÃ©n, biÃ n kÃ n jiÃ n yÃ­ gÃ¨ jÃ¬ng jÃ¬ de yÃ¨.",
        "start": 30.592,
        "end": 44.325
    },
    {
        "text": "ä¸‹é¢æ˜¯ä¸€ç‰‡èœåœ’ï¼Œä¸Šé¢æ˜¯æ˜Ÿç¾¤å¯†å¸ƒçš„è—å¤©ã€‚",
        "pinyin": "XiÃ  mian shÃ¬ yÃ­ piÃ n cÃ i yuÃ¡n, shÃ ng mian shÃ¬ xÄ«ng qÃºn mÃ¬ bÃ¹ de lÃ¡n tiÄn.",
        "start": 44.325,
        "end": 52.021
    },
    {
        "text": "æ˜Ÿå…‰åœ¨æˆ‘å€‘çš„è‚‰çœ¼è£é›–ç„¶å¾®å°ï¼Œç„¶è€Œå®ƒä½¿æˆ‘å€‘è¦ºå¾—å…‰æ˜ç„¡è™•ä¸åœ¨ã€‚",
        "pinyin": "XÄ«ng guÄng zÃ i wÇ’ men de rÃ²u yÇn lÇ suÄ« rÃ¡n wÄ“i xiÇo, rÃ¡n Ã©r tÄ shÇ wÇ’ men juÃ© de guÄng mÃ­ng wÃº chÃ¹ bÃº zÃ i.",
        "start": 52.021,
        "end": 62.126
    },
    {
        "text": "é‚£æ™‚å€™æˆ‘æ­£åœ¨è®€ä¸€äº›å¤©æ–‡å­¸çš„æ›¸ï¼Œä¹Ÿèªå¾—ä¸€äº›æ˜Ÿæ˜Ÿï¼Œå¥½åƒå®ƒå€‘å°±æ˜¯æˆ‘çš„æœ‹å‹ï¼Œå®ƒå€‘å¸¸å¸¸åœ¨å’Œæˆ‘è«‡è©±ä¸€æ¨£ã€‚",
        "pinyin": "NÃ  shÃ­ hou wÇ’ zhÃ¨ng zÃ i dÃº yÃ¬ xiÄ“ tiÄn wÃ©n xuÃ© de shÅ«, yÄ› rÃ¨n de yÃ¬ xiÄ“ xÄ«ng xÄ«ng, hÇo xiÃ ng tÄ men jiÃ¹ shÃ¬ wÇ’ de pÃ©ng you, tÄ men chÃ¡ng chÃ¡ng zÃ i hÃ© wÇ’ tÃ¡n huÃ  yÃ­ yÃ ng.",
        "start": 62.126,
        "end": 78.177
    },
    {
        "text": "å¦‚ä»Šåœ¨æµ·ä¸Šï¼Œæ¯æ™šå’Œç¹æ˜Ÿç›¸å°ï¼Œæˆ‘æŠŠå®ƒå€‘èªå¾—å¾ˆç†Ÿäº†ã€‚",
        "pinyin": "RÃº jÄ«n zÃ i hÇi shÃ ng, mÄ›i wÇn hÃ© fÃ¡n xÄ«ng xiÄng duÃ¬, wÇ’ bÇ tÄ men rÃ¨n de hÄ›n shÃº le.",
        "start": 78.177,
        "end": 87.997
    },
    {
        "text": "æˆ‘èººåœ¨è‰™é¢ä¸Šï¼Œä»°æœ›å¤©ç©ºã€‚",
        "pinyin": "WÇ’ tÇng zÃ i cÄng miÃ n shÃ ng, yÇng wÃ ng tiÄn kÅng.",
        "start": 87.997,
        "end": 94.265
    },
    {
        "text": "æ·±è—è‰²çš„å¤©ç©ºè£æ‡¸ç€ç„¡æ•¸åŠæ˜åŠæ˜§çš„æ˜Ÿã€‚",
        "pinyin": "ShÄ“n lÃ¡n sÃ¨ de tiÄn kÅng lÇ xuÃ¡n zhe wÃº shÃ¹ bÃ n mÃ­ng bÃ n mÃ¨i de xÄ«ng.",
        "start": 94.265,
        "end": 101.016
    },
    {
        "text": "èˆ¹åœ¨å‹•ï¼Œæ˜Ÿä¹Ÿåœ¨å‹•ï¼Œå®ƒå€‘æ˜¯é€™æ¨£ä½ï¼ŒçœŸæ˜¯æ–æ–æ¬²å¢œå‘¢ï¼",
        "pinyin": "ChuÃ¡n zÃ i dÃ²ng, xÄ«ng yÄ› zÃ i dÃ²ng, tÄ men shÃ¬ zhÃ¨ yÃ ng dÄ«, zhÄ“n shÃ¬ yÃ¡o yÃ¡o yÃ¹ zhuÃ¬ ne!",
        "start": 101.016,
        "end": 112.491
    },
    {
        "text": "æ¼¸æ¼¸åœ°æˆ‘çš„çœ¼ç›æ¨¡ç³Šäº†ï¼Œæˆ‘å¥½åƒçœ‹è¦‹ç„¡æ•¸è¢ç«èŸ²åœ¨æˆ‘çš„å‘¨åœé£›èˆã€‚",
        "pinyin": "JiÃ n jiÃ n de wÇ’ de yÇn jing mÃ³ hu le, wÇ’ hÇo xiÃ ng kÃ n jiÃ n wÃº shÃ¹ yÃ­ng huÇ’ chÃ³ng zÃ i wÇ’ de zhÅu wÃ©i fÄ“i wÇ”.",
        "start": 112.491,
        "end": 123.664
    },
    {
        "text": "æµ·ä¸Šçš„å¤œæ˜¯æŸ”å’Œçš„ï¼Œæ˜¯éœå¯‚çš„ï¼Œæ˜¯å¤¢å¹»çš„ã€‚",
        "pinyin": "HÇi shÃ ng de yÃ¨ shÃ¬ rÃ³u hÃ© de, shÃ¬ jÃ¬ng jÃ¬ de, shÃ¬ mÃ¨ng huÃ n de.",
        "start": 123.664,
        "end": 131.627
    },
    {
        "text": "æˆ‘æœ›ç€è¨±å¤šèªè­˜çš„æ˜Ÿï¼Œæˆ‘ä»¿ä½›çœ‹è¦‹å®ƒå€‘åœ¨å°æˆ‘çœ¨çœ¼ï¼Œæˆ‘ä»¿ä½›è½è¦‹å®ƒå€‘åœ¨å°è²èªªè©±ã€‚",
        "pinyin": "WÇ’ wÃ ng zhe xÇ” duÅ rÃ¨n shi de xÄ«ng, wÇ’ fÇng fÃº kÃ n jiÃ n tÄ men zÃ i duÃ¬ wÇ’ zhÇ yÇn, wÇ’ fÇng fÃº tÄ«ng jiÃ n tÄ men zÃ i xiÇo shÄ“ng shuÅ huÃ .",
        "start": 131.627,
        "end": 145.227
    },
    {
        "text": "é€™æ™‚æˆ‘å¿˜è¨˜äº†ä¸€åˆ‡ã€‚",
        "pinyin": "ZhÃ¨ shÃ­ wÇ’ wÃ ng jÃ¬ le yÃ­ qiÃ¨.",
        "start": 145.227,
        "end": 149.653
    },
    {
        "text": "åœ¨æ˜Ÿçš„æ‡·æŠ±ä¸­æˆ‘å¾®ç¬‘ç€ï¼Œæˆ‘æ²‰ç¡ç€ã€‚",
        "pinyin": "ZÃ i xÄ«ng de huÃ¡i bÃ o zhÅng wÇ’ wÄ“i xiÃ o zhe, wÇ’ chÃ©n shuÃ¬ zhe.",
        "start": 149.653,
        "end": 157.48
    },
    {
        "text": "æˆ‘è¦ºå¾—è‡ªå·±æ˜¯ä¸€å€‹å°å­©å­ï¼Œç¾åœ¨ç¡åœ¨æ¯è¦ªçš„æ‡·è£äº†ã€‚",
        "pinyin": "WÇ’ juÃ© de zÃ¬ jÇ shÃ¬ yÃ­ gÃ¨ xiÇo hÃ¡i zi, xiÃ n zÃ i shuÃ¬ zÃ i mÇ” qÄ«n de huÃ¡i lÇ le.",
        "start": 157.48,
        "end": 164.626
    },
    {
        "text": "æœ‰ä¸€å¤œï¼Œé‚£å€‹åœ¨å“¥å€«æ³¢ä¸Šèˆ¹çš„è‹±åœ‹äººæŒ‡çµ¦æˆ‘çœ‹å¤©ä¸Šçš„å·¨äººã€‚",
        "pinyin": "YÇ’u yÃ­ yÃ¨, nÃ  gÃ¨ zÃ i GÄ“ lÃºn bÅ shÃ ng chuÃ¡n de YÄ«ng guÃ³ rÃ©n zhÇ gÄ›i wÇ’ kÃ n tiÄn shÃ ng de jÃ¹ rÃ©n.",
        "start": 164.626,
        "end": 175.063
    },
    {
        "text": "ä»–ç”¨æ‰‹æŒ‡ç€ï¼š",
        "pinyin": "TÄ yÃ²ng shÇ’u zhÇ zhe:",
        "start": 175.063,
        "end": 177.852
    },
    {
        "text": "é‚£å››é¡†æ˜äº®çš„æ˜Ÿæ˜¯é ­ï¼Œä¸‹é¢çš„å¹¾é¡†æ˜¯èº«å­ï¼Œé€™å¹¾é¡†æ˜¯æ‰‹ï¼Œé‚£å¹¾é¡†æ˜¯è…¿å’Œè…³ï¼Œé‚„æœ‰ä¸‰é¡†æ˜Ÿç®—æ˜¯è…°å¸¶ã€‚",
        "pinyin": "NÃ  sÃ¬ kÄ“ mÃ­ng liÃ ng de xÄ«ng shÃ¬ tÃ³u, xiÃ  mian de jÇ kÄ“ shÃ¬ shÄ“n zi, zhÃ¨ jÇ kÄ“ shÃ¬ shÇ’u, nÃ  jÇ kÄ“ shÃ¬ tuÇ hÃ© jiÇo, hÃ¡i yÇ’u sÄn kÄ“ xÄ«ng suÃ n shÃ¬ yÄo dÃ i.",
        "start": 177.852,
        "end": 194.637
    },
    {
        "text": "ç¶“ä»–é€™ä¸€ç•ªæŒ‡é»ï¼Œæˆ‘æœç„¶çœ‹æ¸…æ¥šäº†é‚£å€‹å¤©ä¸Šçš„å·¨äººã€‚",
        "pinyin": "JÄ«ng tÄ zhÃ¨ yÃ¬ fÄn zhÇ diÇn, wÇ’ guÇ’ rÃ¡n kÃ n qÄ«ng chÇ” le nÃ  gÃ¨ tiÄn shÃ ng de jÃ¹ rÃ©n.",
        "start": 194.637,
        "end": 203.791
    },
    {
        "text": "çœ‹ï¼Œé‚£å€‹å·¨äººé‚„åœ¨è·‘å‘¢ï¼",
        "pinyin": "KÃ n, nÃ  gÃ¨ jÃ¹ rÃ©n hÃ¡i zÃ i pÇo ne!",
        "start": 203.791,
        "end": 208.303
    }
];

        // ================= è®Šé‡åˆå§‹åŒ– =================
        const audio = document.getElementById('main-audio');
        const loginScreen = document.getElementById('login-screen');
        const contentArea = document.getElementById('content-area');
        const rewardTrack = document.getElementById('track');
        const rewardContainer = document.getElementById('reward-track-container');
        const finishSection = document.getElementById('finish-section');
        
        let currentUser = "";
        let playingIndex = -1; // ç•¶å‰æ­£åœ¨æ’­æ”¾çš„ç´¢å¼•
        let isPaused = false; // æ˜¯å¦è™•æ–¼æš«åœç‹€æ…‹
        let completedSentences = new Set(); // å·²å®Œæˆçš„å¥å­é›†åˆ
        let checkInterval = null;

        // ================= ç™»éŒ„é‚è¼¯ =================
        function handleLogin() {
            const name = document.getElementById('username').value.trim();
            const pass = document.getElementById('password').value.trim();
            if (!name) {
                alert("è«‹è¼¸å…¥åå­—");
                return;
            }
            if (pass !== "vtcpsc") {
                alert("è«‹è¼¸å…¥æ­£ç¢ºå¯†ç¢¼");
                return;
            }
            currentUser = name;
            loginScreen.style.display = "none";
            contentArea.style.display = "block";
            rewardContainer.style.display = "block";
            initPage();
        }

        document.getElementById('login-btn').addEventListener('click', handleLogin);
        document.addEventListener('keydown', (e) => {
            if (e.key === "Enter" && loginScreen.style.display !== "none") {
                handleLogin();
            }
        });

        // ================= é é¢åˆå§‹åŒ– =================
        function initPage() {
            // ç”Ÿæˆå¥å­åˆ—è¡¨
            sentenceData.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'sentence-block';
                div.id = `block-${index}`;
                div.innerHTML = `
                    <div class="pinyin">${item.pinyin}</div>
                    <div class="hanzi">${item.text}</div>
                    <div class="controls">
                        <button class="play-btn" onclick="togglePlay(${index})">
                            <span class="icon">â–¶</span> <span class="text">æ’­æ”¾</span>
                        </button>
                    </div>
                `;
                contentArea.appendChild(div);

                // ç”Ÿæˆæ˜Ÿæ˜Ÿ
                const star = document.createElement('div');
                star.className = 'star';
                star.innerHTML = 'â˜…'; // å¯¦å¿ƒæ˜Ÿï¼Œé€šéé¡è‰²æ§åˆ¶ç©ºå¿ƒ/å¯¦å¿ƒæ•ˆæœ
                star.id = `star-${index}`;
                rewardTrack.appendChild(star);
            });

            // æ·»åŠ çæ¯
            const trophy = document.createElement('div');
            trophy.className = 'trophy';
            trophy.id = 'trophy';
            trophy.innerHTML = 'ğŸ†';
            rewardTrack.appendChild(trophy);
        }

        // ================= æ’­æ”¾æ§åˆ¶é‚è¼¯ =================
        function togglePlay(index) {
            const data = sentenceData[index];
            const btn = document.querySelector(`#block-${index} .play-btn`);
            
            // å¦‚æœé»æ“Šçš„æ˜¯ç•¶å‰æ­£åœ¨æ’­æ”¾çš„æŒ‰éˆ•
            if (playingIndex === index) {
                if (audio.paused) {
                    // ç¹¼çºŒæ’­æ”¾
                    audio.play();
                    btn.classList.add('playing');
                    btn.querySelector('.icon').innerText = 'â¸';
                    btn.querySelector('.text').innerText = 'æš«åœ';
                    startMonitoring(index);
                } else {
                    // æš«åœ
                    audio.pause();
                    btn.classList.remove('playing');
                    btn.querySelector('.icon').innerText = 'â–¶';
                    btn.querySelector('.text').innerText = 'ç¹¼çºŒ';
                    stopMonitoring();
                }
            } else {
                // é»æ“Šäº†æ–°çš„æ’­æ”¾æŒ‰éˆ•
                resetAllButtons(); // é‡ç½®å…¶ä»–æŒ‰éˆ•
                
                playingIndex = index;
                // å¦‚æœ start å’Œ end éƒ½æ˜¯ 0 (æœªæ ¡æº–)ï¼Œé»˜èªæ’­æ”¾æ•´å€‹éŸ³é »æˆ–æç¤º
                // ç‚ºäº†ç”¨æˆ¶é«”é©—ï¼Œè‹¥æœªæ ¡æº–å‰‡å¾é ­æ’­åˆ°å°¾ (Dev mode ç”¨)
                // ä½†ç‚ºäº†é‚è¼¯æ­£ç¢ºï¼Œæˆ‘å€‘å‡è¨­å·²ç¶“æœ‰æ•¸æ“šã€‚
                // å¦‚æœæ•¸æ“šç‚º0ï¼Œæš«æ™‚åªæ’­æ”¾ï¼Œä¸é™åˆ¶çµæŸæ™‚é–“ï¼ˆæˆ–è€…ä¸æ’­æ”¾ï¼Œå–æ±ºæ–¼éœ€æ±‚ï¼‰
                // é€™è£è¨­ç½®ç‚ºè·³è½‰åˆ° start
                
                audio.currentTime = data.start;
                audio.play();
                
                btn.classList.add('playing');
                btn.querySelector('.icon').innerText = 'â¸';
                btn.querySelector('.text').innerText = 'æš«åœ';
                startMonitoring(index);
            }
        }

        function resetAllButtons() {
            document.querySelectorAll('.play-btn').forEach(b => {
                b.classList.remove('playing');
                b.querySelector('.icon').innerText = 'â–¶';
                b.querySelector('.text').innerText = 'æ’­æ”¾';
            });
            stopMonitoring();
        }

        function startMonitoring(index) {
            stopMonitoring();
            checkInterval = setInterval(() => {
                const data = sentenceData[index];
                
                // æª¢æŸ¥æ˜¯å¦çµæŸ
                // æ³¨æ„ï¼šå¦‚æœ end ç‚º 0ï¼Œèª¬æ˜æ˜¯é–‹ç™¼æ¨¡å¼é‚„æœªæ¨™è¨˜ï¼Œé€™è£ä¸åšåœæ­¢ï¼Œæ–¹ä¾¿éŒ„è£½
                if (data.end > 0 && audio.currentTime >= data.end) {
                    audio.pause();
                    resetAllButtons();
                    markFinished(index);
                }
            }, 50);
        }

        function stopMonitoring() {
            if (checkInterval) clearInterval(checkInterval);
        }

        function markFinished(index) {
            if (!completedSentences.has(index)) {
                completedSentences.add(index);
                // è®Šè‰²
                document.getElementById(`block-${index}`).classList.add('finished');
                // é»äº®æ˜Ÿæ˜Ÿ
                document.getElementById(`star-${index}`).classList.add('active');
                
                checkAllFinished();
            }
        }

        function checkAllFinished() {
            if (completedSentences.size === sentenceData.length) {
                document.getElementById('trophy').classList.add('active');
                document.getElementById('finish-section').style.display = 'block';
                // æ»¾å‹•åˆ°åº•éƒ¨
                window.scrollTo(0, document.body.scrollHeight);
            }
        }

        // ================= å®ŒæˆåŠå½ˆçª—é‚è¼¯ =================
        document.getElementById('finish-all-btn').addEventListener('click', () => {
            document.getElementById('success-modal').style.display = 'flex';
            
            // è¤‡è£½ä¿¡æ¯
            const today = new Date();
            const dateStr = `${today.getMonth() + 1}æœˆ${today.getDate()}æ—¥`;
            const msg = `${currentUser}å·²æ–¼${dateStr}å®Œæˆä½œå“10è™Ÿè·Ÿè®€ç·´ç¿’ï¼`;
            
            navigator.clipboard.writeText(msg).catch(err => {
                console.error('è¤‡è£½å¤±æ•—:', err);
            });
        });

        document.getElementById('close-modal').addEventListener('click', () => {
            document.getElementById('success-modal').style.display = 'none';
            document.getElementById('finish-section').style.display = 'none';
            document.getElementById('home-section').style.display = 'block';
        });

        // ================= é–‹ç™¼è€…æ¨¡å¼ (æ ¸å¿ƒ) =================
        const devTrigger = document.getElementById('dev-trigger');
        const devPanel = document.getElementById('dev-panel');
        const startRecBtn = document.getElementById('start-record-btn');
        const markBtn = document.getElementById('mark-point-btn');
        const exportBtn = document.getElementById('export-btn');
        const jsonOutput = document.getElementById('json-output');
        const timeDisplay = document.getElementById('current-time-display');

        let isDevMode = false;
        let recordingData = [];
        let currentRecIndex = 0;

        devTrigger.addEventListener('click', () => {
            devPanel.style.display = devPanel.style.display === 'block' ? 'none' : 'block';
            isDevMode = true;
            // é–‹ç™¼æ¨¡å¼ä¸‹å¼·åˆ¶é¡¯ç¤ºæ’­æ”¾å™¨ä»¥ä¾¿èª¿è©¦
            audio.style.display = 'block';
            audio.style.position = 'fixed';
            audio.style.bottom = '300px'; 
            audio.style.left = '0';
            audio.style.width = '100%';
            audio.style.zIndex = '5000';
        });

        startRecBtn.addEventListener('click', () => {
            // åˆå§‹åŒ–éŒ„è£½
            recordingData = JSON.parse(JSON.stringify(sentenceData));
            currentRecIndex = 0;
            audio.currentTime = 0;
            audio.play();
            
            // è¨˜éŒ„ç¬¬ä¸€å¥é–‹å§‹æ™‚é–“
            recordingData[0].start = 0;
            
            jsonOutput.innerText = `æ­£åœ¨éŒ„è£½ç¬¬ 1 å¥...`;
            
            // å¯¦æ™‚é¡¯ç¤ºæ™‚é–“
            setInterval(() => {
                timeDisplay.innerText = audio.currentTime.toFixed(3) + 's';
            }, 50);
        });

        function markNext() {
            const now = audio.currentTime;
            
            // è¨˜éŒ„ç•¶å‰å¥å­çš„çµæŸæ™‚é–“
            if (currentRecIndex < recordingData.length) {
                recordingData[currentRecIndex].end = parseFloat(now.toFixed(3));
                
                // æº–å‚™ä¸‹ä¸€å¥
                currentRecIndex++;
                if (currentRecIndex < recordingData.length) {
                    recordingData[currentRecIndex].start = parseFloat(now.toFixed(3));
                    jsonOutput.innerText = `å·²æ¨™è¨˜ç¬¬ ${currentRecIndex} å¥çµæŸã€‚æ­£åœ¨éŒ„è£½ç¬¬ ${currentRecIndex + 1} å¥...`;
                    // è‡ªå‹•æ»¾å‹•åˆ°å°æ‡‰æ–‡æœ¬ï¼ˆå¯é¸ï¼‰
                    document.getElementById(`block-${currentRecIndex}`).scrollIntoView({behavior: "smooth", block: "center"});
                } else {
                    jsonOutput.innerText = "éŒ„è£½å®Œæˆï¼è«‹é»æ“Šã€Œè¤‡è£½ JSON ä»£ç¢¼ã€ã€‚";
                    audio.pause();
                }
            }
        }

        markBtn.addEventListener('click', markNext);
        document.addEventListener('keydown', (e) => {
            if (isDevMode && devPanel.style.display === 'block' && e.code === 'Space') {
                e.preventDefault(); // é˜²æ­¢æ»¾å‹•
                markNext();
            }
        });

        exportBtn.addEventListener('click', () => {
            const jsonStr = JSON.stringify(recordingData, null, 4); // æ ¼å¼åŒ–è¼¸å‡º
            navigator.clipboard.writeText(jsonStr).then(() => {
                alert("JSON å·²è¤‡è£½ï¼è«‹å›åˆ°ä»£ç¢¼ä¸­æ›¿æ› sentenceData è®Šé‡ã€‚");
            });
            jsonOutput.innerText = jsonStr; // é¡¯ç¤ºåœ¨é¢æ¿ä¸Š
        });

    </script>
</body>
</html>
